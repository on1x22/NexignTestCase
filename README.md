# NexignTestCase

## Api игры "Камень, ножницы, бумага"

Реализация api основана на правилах игры "Камень, ножницы, бумага". 

### Технологический стек:
- .Net 7.0
- EntityFrameworkCore
- Docker

### Инструкция по запуску проекта
Для упрощения процесса разработки и запуска тестовая программа размещена в docker-контейнере. Для хранения информации используется InMemoryDatabase.

Шаги для запуска docker-контейнера:
1. Выполнить клонирование проекта в локальный репозиторий с помощью команды
   > git clone https://github.com/on1x22/NexignTestCase
2. Перейти в директирию проекта и создать образ с помощью команды
   > docker build -f RockPaperScissors/Dockerfile -t rockpaperscissors:dev .
    
   где rockpaperscissors - имя образа,  
   dev - тег образа
3. Создать контейнер с приложением
   > docker run --name rockpaperscissors -p 9999:80 -d rockpaperscissors:dev

   где rockpaperscissors - название контейнера,  
   9999 - порт хоста,  
   80 - внутрений порт контейнера

После выполнения описанных выше команд приложение будет доступно на локальном компьютере по протоколу http и заданному порту. Например, http://localhost:9999.

### Общие правила игры
В основе api лежат классические правила игры "Камень, ножницы, бумага". Участвует два игрока. Каждый из них во время розыгрыша одновременно показывает рукой один из трех возможных жестов (камень, ножницы или бумагу), после чего определяется победитель. 

#### Возможные комбинации в игре
1. Камень - ножницы (побеждает игрок, показавший камень)
2. Камень - бумага (побеждает игрок, показавший бумагу)
3. Ножницы - бумага (побеждает игрок, показавший ножницы)
4. При одинаковых жестах объявляется ничья.
   
### Правила игры в приложении
Игра состоит из раундов, в каждом из которых проиходит розыгрыш. Игра ведется до победы одного из участников в 3 раундах или до достижения максимального количества раундов 5. В таком случае побеждает игрок выйгравший в большем количестве раундов.


### Функциональность api
localhost - далее по тексту данное сокращение включает в себя протокол, IP-адрес хоста, а также порт доступа.
В api доступны следующие конечные точки:
#### 1. [POST] localhost/game/create?:playerName1
Создает игру по имени игрока (playerName1). Запрос возвращает строку с Id первого игрока и Id игры.  

#### 2. [POST] localhost/game/{gameId}/join/{playerName2}
Подключает игрока с именем playerName2 к игре с идентификатором gameId. При успешной обработке запроса с Id второго игрока и Id игры.

#### 3. [POST] localhost/game/{gameId}/user/{playerId}/{turn}
Выполняет ход игрока turn с идентификатором playerId в игре с идентификатором gameId. При завершении хода первого игрока возвращается сообщение информирующее о завершении хода. При завершении хода второго игрока возвращается обобщенная информация о ходе каждого игрока и победителе текущего раунда.

#### 4. [GET] localhost/game/{gameId}/stat
Возвращет полную статистику по проведенной игре с идентификатором gameId: номер игры, номера раундов, ходы каждого из участников, а также результаты раундов и игры. Данная статистика отображается только при полном завершении игры. При несоблюдении условий завершения игры возвращается информационное сообщение.

#### 5. [GET] localhost/game/{gameId}/stat/current
Возвращет текущую статистику по завершенным раундам в игре с идентификатором gameId. Перечень отображаемой информации аналогичен вышестоящей конечной токче с тем отличием, что возвращаются результаты не по всей игре в целом, а только о завершенных раундах в игре. Если в текущем раунде ход сделал только первый игрок, статистика по такому раунду отображаться не будет.

### Игра с компьютером
Api позволяет проводить игру не только между двумя людьми, но и против компьютера. В таком случае использование api имеет отличия от того, что было описано в разделе выше. Компьютер всегда является вторым игроком, автоматически подключается к игре и автоматически выполняет ход без ручного ввода дополнительных параметров.

В режиме игры с компьютером изменяется конечная точка создания игры:
#### [POST] localhost/game/create?:playerName1&:withComputer
Создает игру по имени игрока (playerName1). Запрос содержит необязательное поле bool withComputer со значением по умолчанию false (игра не против компьютера). При значении данного парамера true после создания новой игры автоматически выполняется подключение компьютера к новой игре. При успешной обработке запроса возвращается информация о подключении компьютера к игре.




















